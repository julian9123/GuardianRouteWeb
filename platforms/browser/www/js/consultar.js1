"use strict";var fecha,codDriverKey,latLocal,lngLocal,imageSchool,tableRef,source,titlePlate,startDate,endDate,numberDoc,nameDocument,upLoadDoc,docDriver,UpLoadResult,resultValidate,posRuta={},gpRutas=[],siExiste="N",siEliminar="N",driverRoute="",regDateDriver="",plateRoute="",nameRoute="",codDriverRoute="",intCnsRoute=0,lastRouteAdded="",codePoint=0,myTypeRoute="",refStorages="",dataDriverUpdate=[],onlySave=0,docsPdf=["cedula_ciudadania.pdf","licencia_conduccion.pdf","hoja_de_vida.pdf","soat.pdf","matricula.pdf","tecnomecanica.pdf","tarjeta_funcionamiento.pdf"];function d2(e){return e<9?"0"+e:e}function formatoFecha(){fecha=(fecha=new Date).getFullYear()+"-"+d2(parseInt(fecha.getMonth()+1))+"-"+d2(fecha.getDate())+" "+d2(fecha.getHours())+":"+d2(fecha.getMinutes())+":"+d2(fecha.getSeconds())}function formatoHora(){var e=new Date,t=12<e.getHours()?"P.M.":"A.M.";return e.getHours()+":"+e.getMinutes()+" "+t}function formatoFechaCorta(){return(fecha=new Date).getFullYear()+""+d2(parseInt(fecha.getMonth()+1))+d2(fecha.getDate())}function guardarPosicion(e){if(1!=validBrowser){if(contador++,formatoFecha(),""==myUserId&&initApp(),""==myUserId&&3<contador)return alert("Este navegador no soporta Firebase.  Se recomienda Google Crhome"),void(validBrowser=1);distancia++;var t=(new Date).getTime(),a=new Date;conn.database().ref("logDetail/JOAG1013/"+t).set({hour:a.getHours(),minutes:a.getMinutes(),useId:myUserId,fecha:fecha,ahora:t,latitud:e.lat+distancia/1e5,longitud:e.lng+distancia/1e5,precision:distancia}).then(function(){console.log("dato almacenado correctamente")}).catch(function(e){alert("detectado un error",e)})}}function formatoMsjDialog(e,t){var a=document.getElementById(e);a.textContent=t,a.removeAttribute("class"),a.setAttribute("class","textFormatoError"),abrirOpcionModal("m-msjError")}function registroDatos(){if(userName=$("#txtNombres").val(),""!=userName)if(userLastName=$("#txtApellidos").val(),""!=userLastName){var e=document.getElementById("paisCelular"),t=e.options[e.selectedIndex].value;if(""!=t)if(userCellPhone=$("#txtCelular").val(),""!=userCellPhone){var a=$("#txtCodRuta").val();if(""!=a)cnsEntGroup(a),conn.database().ref(tblRtAlt[9]+"/"+a).orderByValue().on("value",function(e){(entUser=e.child("entCode").val(),null==entUser)?(formatoMsjDialog("dataError1","Código de empresa erróneo. Comuníquese a la linea de soporte 3214745999 o escribanos soporteguardianrutas@gmail.com"),a=""):(""==myUserId&&initApp(),userName=getCapitalLetter(userName),userLastName=getCapitalLetter(userLastName),conn.database().ref(tblRtAlt[8]+"/"+myUserId+"/"+a).set({userName:userName,userlastName:userLastName,userCellPhone:userCellPhone,paisSel:t}).then(function(){console.log("dato almacenado correctamente"),cambioPagina("mapaRuta.html")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[8],"registroDatos"),console.log("detectado un error",e)}))});else formatoMsjDialog("dataError1","Debes ingresar el codigo de la empresa para continuar")}else formatoMsjDialog("dataError1","Debes ingresar un numero celular para continuar");else formatoMsjDialog("dataError1","Debes seleccionar un indicativo para continuar")}else formatoMsjDialog("dataError1","Debes ingresar por lo menos un apellido para continuar");else formatoMsjDialog("dataError1","Debes ingresar por lo menos un nombre para continuar")}function cnsUsuarioEmpresa(){var e;(intentos=0,registrado=0,""==entUser||null==entUser)&&(initApp(),null!=myUserId&&""!=myUserId?(clearTimeout(e),conn.database().ref(tblRtAlt[8]+"/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){if(registrado++,entUser=e.key,""==entUser||null==entUser||null==entUser)return msjAlert("Usted no esta autorizado para ingresar a esta opción",2),void setTimeout(function(){cambioPagina("index.html")},5e3);conn.database().ref(tblRtAlt[9]+"/"+entUser).orderByValue().on("value",function(e){entChoose="",2==e.child("est").val()&&(entChoose="enterprise")})})}),null==entUser||""==entUser?e=setTimeout(cnsUsuarioEmpresa,1e3):clearTimeout(e)):e=setTimeout(cnsUsuarioEmpresa,1e3))}function cnsMovRutasDetalle(){conn.database().ref("logDetail/"+myUserId+"/"+empresa).orderByValue().on("value",function(e){e.forEach(function(e){registrado++})})}function cnsMovRutasDetalleXX(){}function csnRouteEnt(o){var r=0;if(""!=o&&null!=o&&(conn.database().ref("datacar/"+o).orderByValue().on("value",function(e){e.forEach(function(e){r=1;var t=document.getElementById("routeFind");t.textContent="Vehiculo encontrado: "+o,t.setAttribute("class","textConfirmVehicleTrue");var a=document.getElementById("routeFindRem");null!=a&&(a.textContent="Vehiculo encontrado: "+o),null!=a&&a.setAttribute("class","textConfirmVehicleTrue")})}),0==r)){var e=document.getElementById("routeFind");e.textContent="Vehiculo no encontrado",e.setAttribute("class","textConfirmVehicleFalse");var t=document.getElementById("routeFindRem");t.textContent="Vehiculo no encontrado",t.setAttribute("class","textConfirmVehicleFalse"),abrirOpcionModal("m-CnfAddRoute")}}function cnsUserEnt(){var e;(intentos=0,registrado=0,initApp(),null!=myUserId&&""!=myUserId)?(clearTimeout(e),conn.database().ref("entUser/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){entUser=e.key,entCode=e.key,registrado=1})},function(e){console.log("Error:"+e.code)}),""==entCode||null==entCode?e=setTimeout(cnsUserEnt,1e3):clearTimeout(e)):e=setTimeout(cnsUserEnt,1e3)}function msjAlert(e,t){abrirOpcionModal("m-MsjAds");var a=document.getElementById("msjAds");1==t&&(a.innerHTML=e,a.setAttribute("style","color: #000000")),2==t&&(a.innerHTML=e,a.setAttribute("style","color: #DF0101"))}function addRoute(){formatoFecha(),""==myUserId&&initApp(),""==myUserId&&initApp(),""==myUserId&&initApp(),""==entCode&&cnsUserEnt(),""==entCode&&cnsUserEnt(),""==entCode&&cnsUserEnt();var e=$("#txtRuta").val();(e=minToMayus(e),cnsRouteExistEnt(myUserId,e),0<registrado)?msjAlert("Ruta "+e+" ya fue registrada",2):lastRouteAdded!=e?(csnRouteEnt(lastRouteAdded=e),conn.database().ref(tblRtAlt[8]+"/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){entUser=e.key,null==codRuta&&(codRuta=""),conn.database().ref(tblRtAlt[2]+"/"+entUser+"/"+lastRouteAdded).set({date:fecha,user:myUserId,routeCode:codRuta,plateCode:lastRouteAdded,entCode:entUser}).then(function(){msjAlert("dato almacenado correctamente",1),closePopUp("m-AddRoute"),$("#txtRuta").val("")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[2],"addRoute"),msjAlert("2 Error al guardar los datos: "+e,2)})})},function(e){console.log("Error:"+e.code)}),listVehicle()):console.log("UltimaRuta Registrada: "+lastRouteAdded)}function cnsRouteExistEnt(e,a){registrado=0,conn.database().ref("entUser/"+e).orderByValue().on("value",function(e){e.forEach(function(e){var t=e.key;entUser=t,conn.database().ref("entRoute/"+entUser+"/"+a).orderByValue().on("value",function(e){e.forEach(function(e){registrado=1,siExiste="S"})})})},function(e){console.log("Error:"+e.code)})}function cnsEntGroup(e){intentos=0,registrado=0,conn.database().ref("entGroup/"+e).orderByValue().on("value",function(e){entUser=e.child("entCode").val()})}function confirmaRemRoute(){siEliminar="S";var e=$("#txtRutaRem").val();remRouteEnt(e),closePopUp("m-CnfRemRoute"),$("#txtRutaRem").val(""),remFile(document.getElementById("listaVehiculosDel").getElementsByTagName("li"),e),remFile(document.getElementById("listaVehiculos").getElementsByTagName("li"),e);var t=document.getElementById("routeFindRem");null!=t&&(t.textContent="")}function remFile(e,t){for(var a=0;a<e.length;a++)if(e[a].innerHTML.includes(t)){var o=e[a].getAttribute("id"),r=document.getElementById(o);r.parentNode.removeChild(r)}}function remRoute(){formatoFecha(),""==myUserId&&initApp(),""==entCode&&cnsUserEnt();var e=$("#txtRutaRem").val();""!=e&&(cnsRouteExistEnt(myUserId,e),0!=registrado?(csnRouteEnt(e),"N"!=siExiste&&abrirOpcionModal("m-CnfRemRoute")):msjAlert("Ruta "+e+" no pertenece a la empresa",2))}function remRouteList(e){campoDiligenciado("RutaRem"),$("#txtRutaRem").val(e),remRoute()}function remRouteEnt(t){""==myUserId&&initApp(),""==entCode&&cnsUserEnt(),conn.database().ref("entUser/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){entUser=e.key,conn.database().ref("entRoute/"+entUser+"/"+t).remove().then(function(){$("#txtRutaRem").val(""),msjAlert("Vehiculo desvinculado correctamente",1)}).catch(function(e){setLogErrorData("Error: "+e,"Borrar","entRoute","remRouteEnt"),msjAlert("Error al borrar el vehiculo: "+e,2)})})}),location.reload(!0)}function cnsUserExistEnt(){intentos=0,registrado=0;(""==myUserId&&initApp(),""!=myUserId&&null!=myUserId)&&conn.database().ref("entUser/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){registrado++,entRoute=e.key,conn.database().ref(tblRtAlt[9]+"/"+entRoute).orderByValue().on("value",function(e){e.forEach(function(e){"est"==e.key&&2==e.val()&&(entChoose="enterprise"),"est"==e.key&&2!=e.val()&&(entChoose="")})})})})}function strDataRoute(){}function cnsDataRoute(){intentos=0,registrado=0;var o=$("#txtRutaCns").val().trim();if(""!=o.trim()){var r=[],e=0,t=0,a=0,n=0;if(conn.database().ref("logDetail/"+o).orderByValue().on("value",function(e){e.forEach(function(e){var t=e.val(),a={};a.latitud=t.latitud,a.longitud=t.longitud,a.fecha=t.fecha,r.push(a)})}),initApp(),""==myUserId&&initApp(),conn.database().ref("drivervstravel").orderByValue().on("value",function(e){e.forEach(function(e){e.val();var a=e.key;conn.database().ref("drivervstravel/"+a).orderByValue().on("value",function(e){e.forEach(function(e){if(e.key==o.trim()){var t=e.val();codDriverRoute=a,nameRoute=t.name,plateRoute=t.plate,intCnsRoute++}})})})}),1<intCnsRoute&&intCnsRoute<4&&""==plateRoute.trim())return strDataRoute(),void cnsDataRoute();if(intCnsRoute=0,""!=plateRoute.trim()){conn.database().ref("datadriver/"+codDriverRoute).orderByValue().on("value",function(e){e.forEach(function(e){var t=e.val(),a=e.key;"lastnameconductor"==a&&(driverRoute=t),"nameconductor"==a&&(driverRoute+=" "+t),"registerDate"==a&&(regDateDriver=t)})}),document.getElementById("placaRuta").textContent="Placa: "+plateRoute,document.getElementById("nomCoductor").textContent="Condutor: "+driverRoute,document.getElementById("nomRuta").textContent="Ruta: "+nameRoute,document.getElementById("fechaRuta").textContent="Fecha Inicio: "+regDateDriver,console.log("Largo "+r.length);for(var l=registrado=0,c=1;c<r.length;c++)a=r[c].latitud,n=r[c].longitud,0==registrado&&(e=r[c-1].latitud,t=r[c-1].longitud,l=getKilometros(e,t,a,n),intentos+=l,0),registrado++,19==registrado&&(registrado=0);document.getElementById("distanciaRuta").textContent="Distancia Recorrida: "+intentos.toPrecision(3)+" Km",document.getElementById("kiloRuta").textContent="Velocidad Promedio: "+intentos.toPrecision(3)+" Km/H"}else strDataRoute()}}function cnsUrlRoute(){var e=$("#txtRutaUrl").val();if(""!=e)if(markers.includes(e)){for(var t in markers)if(console.log("RutaM:"+markers[t].ruta),markers[t].ruta==e){console.log("URlM:"+markers[t].url);markers[t].url}}else{var a=document.getElementById("youtubeFrame");a.textContent="Ruta "+e+" no pertenece a la empresa",a.setAttribute("style","color: #DF0101")}}function createEnterprise(){(formatoFecha(),obtenercodEmp("EMP"),console.log(codRuta),""!=codRuta)&&conn.database().ref("entGroup/"+codRuta).set({dir:"Calle "+codRuta,est:1,fecreg:fecha,nit:"80000000",tel:"300456889",nom:"Empresa "+codRuta,entCode:codRuta}).then(function(){msjAlert("dato almacenado correctamente",1),$("#txtRuta").val("")}).catch(function(e){msjAlert("Error al guardar los datos: "+e,2),setLogErrorData("Error: "+e,"Insertar",entGroup,"createEnterprise")})}function confirmaAddRoute(){var e=$("#txtRuta").val();""!=e.trim()&&(e=minToMayus(e),conn.database().ref("datacar/"+e).set({coderoute:"",distancia:0,latitud:myLat,longitud:myLong}).then(function(){}).catch(function(e){setLogErrorData("Error: "+e,"Insertar","datacar","confirmaAddRoute"),msjAlert("Error al guardar los datos: "+e,2)}),conn.database().ref("datacars/"+e).set({matricula:e}).then(function(){}).catch(function(e){setLogErrorData("Error: "+e,"Insertar","datacars","confirmaAddRoute"),msjAlert("Error al guardar los datos: "+e,2)}),addRoute())}function sendNotification(e){var o,r=$("#notificacion").val(),t=new Date,a=12<t.getHours()?"p.m.":"a.m.",n=t.getHours()+":"+t.getMinutes()+" "+a;"forMe"===e&&conn.database().ref(tblRtAlt[0]+"/"+codeRouteSel).set({type:9,hour:n,message:r,sended:0}).then(function(){document.getElementById("footer").innerHTML="<strong>Notificación enviada la ruta "+codeRouteSel+"...<strong>",document.getElementById("footer").setAttribute("class","visible"),o=setTimeout("document.getElementById('footer').setAttribute('class','invisible')",5e3),$("#notificacion").val("")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar","alert","sendNotification"),msjAlert("Error mensaje enviado: "+e,2),clearTimeout(o)});if("forAll"===e)for(var l=0,c=0;c<markers.length;c++){var i=markers[c].placa;conn.database().ref(tblRtAlt[5]+"/"+i).orderByValue().on("value",function(a){a.forEach(function(e){var t=e.val();conn.database().ref(tblRtAlt[0]+"/"+t.id).set({type:9,hour:n,message:r,sended:0}).then(function(){++l===a.numChildren()&&($("#notificacion").val(""),document.getElementById("footer").innerHTML="<strong>Notificación enviada a todas las rutas...<strong>",document.getElementById("footer").setAttribute("class","visible"),o=setTimeout("document.getElementById('footer').setAttribute('class', 'invisible');",5e3))}).catch(function(e){setLogErrorData("Error: "+e,"Insertar","alert","sendNotification"),msjAlert("Error mensaje enviado: "+e+" Ruta: "+t,2),clearTimeout(o)})})})}}function addRouteEnt(){formatoFecha(),""==myUserId&&initApp(),""==entCode&&cnsUserEnt();var e=$("#txtRuta").val();e.trim().length<6||""!=e.trim()&&(e=minToMayus(e),cnsRouteExistEnt(myUserId,e),0<registrado?msjAlert("Ruta "+e+" ya fue registrada",2):lastRouteAdded!=e?(csnRouteEnt(lastRouteAdded=e),conn.database().ref(tblRtAlt[8]+"/"+myUserId).orderByValue().on("value",function(e){e.forEach(function(e){entUser=e.key,conn.database().ref(tblRtAlt[2]+"/"+entUser+"/"+lastRouteAdded).set({date:fecha,user:myUserId,routeCode:codRuta,plateCode:lastRouteAdded,entCode:entUser}).then(function(){console.log("dato almacenado correctamente 2")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[2],"addRouteEnt"),msjAlert("2 Error al guardar los datos: "+e,2),document.getElementById("routeFind").textContent="",$("#txtRuta").val(""),$("#txtNewRouteV").val("")})})},function(e){console.log("Error:"+e.code),document.getElementById("routeFind").textContent="",$("#txtRuta").val(""),$("#txtNewRouteV").val("")}),closePopUp("m-CnfAddRoute"),complementData(1),listVehicle(),document.getElementById("routeFind").textContent="",$("#txtRuta").val(""),$("#txtNewRouteV").val("")):console.log("UltimaRuta Registrada: "+lastRouteAdded))}function confirmaAddRouteEnt(){var e=$("#txtRuta").val(),t=$("#txtNewRouteV").val(),a=document.getElementById("txtOptEnt1"),o=a.options[a.selectedIndex].value;""!=e.trim()?""!=t.trim()?("escolar"==o&&0,"empresarial"==o&&1,""!=o?(myTypeRoute=o,e=minToMayus(e),getCodRoute(),conn.database().ref(tblRtAlt[3]+"/"+e).set({coderoute:codRuta,distancia:0,latitud:myLat,longitud:myLong}).then(function(){console.log("dato almacenado correctamente 3")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[3],"confirmaAddRouteEnt"),msjAlert("3 Error al guardar los datos: "+e,2)}),conn.database().ref(tblRtAlt[4]+"/"+e).set({matricula:e}).then(function(){console.log("dato almacenado correctamente 4")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[4],"confirmaAddRouteEnt"),msjAlert("4 Error al guardar los datos: "+e,2)}),addRouteEnt()):msjAlert("No ha seleccionado el tipo de ruta",2)):msjAlert("No ha ingresado un nombre de ruta",2):msjAlert("No ha ingresado un numero de placa",2)}function complementData(e){var t=$("#txtNewRouteV").val();""==t&&(t=$("#txtNewRoute").val());var a,o,r=0;if("escolar"==(o=""==myTypeRoute?(a=document.getElementById("txtOptEnt")).options[a.selectedIndex].value:myTypeRoute)&&(r=0),"empresarial"==o&&(r=1),""!=t)if(""!=o){if(1!=e&&(""==myUserId&&initApp(),lastRouteAdded=plateRouteSel,t=$("#txtNewRoute").val(),$("#txtOptEnt").get(0).selectedIndex=0,$("#txtOptEnt1").get(0).selectedIndex=0,getCodRoute()),t=getCapitalLetter(t),conn.database().ref(tblRtAlt[5]+"/"+lastRouteAdded+"/"+codRuta).set({id:codRuta,name:t,paradas:0,placa:lastRouteAdded,preruta:2,tiporuta:r,controlida:0,controlregreso:0}).then(function(){console.log("dato almacenado correctamente 5")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[5],"complementData"),msjAlert("5 Error al guardar los datos: "+e,2),resetComplementData()}),conn.database().ref(tblRtAlt[6]+"/"+codRuta).set({estado:0,hourfin:"",latitud:myLat,longitud:myLong,tiempo:0,tipo:0,velocidad:0,parada:0}).then(function(){console.log("dato almacenado correctamente 6")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[6],"complementData"),msjAlert("6 Error al guardar los datos: "+e,2),resetComplementData()}),1==e)conn.database().ref(tblRtAlt[7]+"/"+lastRouteAdded).set({keyid:myUserId}).then(function(){console.log("dato almacenado correctamente 7")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[7],"complementData"),msjAlert("7 Error al guardar los datos: "+e,2),resetComplementData()});conn.database().ref(tblRtAlt[0]+"/"+codRuta).set({hour:"00:00 a.m.",type:0}).then(function(){console.log("dato almacenado correctamente 9")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[0],"complementData"),msjAlert("9 Error al guardar los datos: "+e,2),resetComplementData()}),1==e?msjAlert("Vehículo "+minToMayus($("#txtRuta").val())+" vinculado",1):(""!=$("#txtNewRoute").val()&&msjAlert("Ruta "+getCapitalLetter($("#txtNewRoute").val())+" creada",1),""!=$("#txtNewRouteV").val()&&msjAlert("Ruta "+getCapitalLetter($("#txtNewRouteV").val())+" creada",1)),resetComplementData(),deleteLi("listaRutas"),getDataCar("Placa: "+lastRouteAdded),closePopUp("m-CnfAddNewRoute")}else msjAlert("No ha seleccionado el tipo de ruta",2);else msjAlert("No ha ingresado el nombre de ruta",2)}function resetComplementData(){$("#txtNewRoute").val(""),plateRouteSel="",$("#txtNewRouteV").val(""),$("#txtOptEnt").get(0).selectedIndex=0,$("#txtOptEnt1").get(0).selectedIndex=0,myTypeRoute=""}function setNewAccessPoint(){var e=$("#txtEmpleado").val(),t=$("#txtDireccion").val(),a=$("#txtCiudad").val(),o=$("#txtCelularX").val();""!=e?""!=t?""!=a?""!=o?(e=getCapitalLetter(e),getCodePoint(),t=(t=getCapitalLetter(t))+" "+(a=getCapitalLetter(a)),console.log("setNewAccessPoint "+t)):msjAlert("No ha ingresado el número celular",2):msjAlert("No ha ingresado la ciudad",2):msjAlert("No ha ingresado la dirección",2):msjAlert("No ha ingresado el nombre del usuario",2)}function setPositionPoint(e,t,a){var o="";if(0!=latLocal&&0!=lngLocal){if($("#ckbPuntoLlegada").is(":checked")){o=codeRouteSel+"ZZSCHOOL",imageSchool="schoolmarket";var r=conn.database().ref(tblRtAlt[6]+"/"+codeRouteSel),n=formatoHora();r.update({estado:2,hourfin:n}).then(function(){console.log("setNewAccessPoint Parada llegada: "+codeRouteSel)}).catch(function(e){setLogErrorData("Error: "+e,"Actualizar",tblRtAlt[6],"setPositionPoint"),console.log("Error al actualizar parada llegada: "+e)});r=conn.database().ref(tblRtAlt[5]+"/"+plateRouteSel+"/"+codeRouteSel),n=formatoHora();r.update({preruta:1}).then(function(){console.log("setNewAccessPoint Parada llegada2: "+codeRouteSel)}).catch(function(e){setLogErrorData("Error: "+e,"Actualizar",tblRtAlt[5],"setPositionPoint"),console.log("Error al actualizar parada llegada2: "+e)})}else o=codeRouteSel+alphaUp[codePoint],imageSchool="marketend";(r=conn.database().ref(tblRtAlt[10]+"/"+o+"/"+codeRouteSel)).set({alerttone:1e3,code:codeRouteSel,nameroute:nameRouteSel}).then(function(){console.log("dato almacenado correctamente 10")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[10],"setPositionPoint"),msjAlert("10 Error al guardar los datos: "+e,2)}),(r=conn.database().ref(tblRtAlt[11]+"/"+codeRouteSel+"/"+o)).set({check:"n",childname:t,code:codeRouteSel,direccion:e,distance:1e5,icon:imageSchool,iconface:"R.drawable."+imageSchool,id:o,latitud:latLocal,longitud:lngLocal,messageuser:"go",nametutor:t,phone:a,stopedregreso:0,stopedida:0}).then(function(){console.log("dato almacenado correctamente 11")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[11],"setPositionPoint"),msjAlert("11 Error al guardar los datos: "+e,2)}),(r=conn.database().ref(tblRtAlt[12]+"/"+o)).set({phone:a,user:o}).then(function(){console.log("dato almacenado correctamente 12")}).catch(function(e){setLogErrorData("Error: "+e,"Insertar",tblRtAlt[12],"setPositionPoint"),msjAlert("12 Error al guardar los datos: "+e,2)}),msjAlert("El usuario: "+getCapitalLetter($("#txtEmpleado").val())+", dirección: "+getCapitalLetter($("#txtDireccion").val())+" "+getCapitalLetter($("#txtCiudad").val())+", Celular: "+$("#txtCelularX").val()+", ha sido registrado correctamente",1),$("#txtEmpleado").val(""),$("#txtDireccion").val(""),$("#txtCelularX").val(""),$("#txtCiudad").val("")}else msjAlert("No ha ingresado una dirección correcta",2)}function getLatLngDireccion(a,o,r){var e=new google.maps.Geocoder;lngLocal=latLocal=0,""!=a&&e.geocode({address:a},function(e,t){"OK"==t?(latLocal=e[0].geometry.location.lat(),lngLocal=e[0].geometry.location.lng(),setPositionPoint(a,o,r),centerMap=0):(msjAlert("Error al obtener coordenadas de la dirección: "+t,2),console.log("Error getLatLngDireccion(): "+t))})}function getCodePoint(){codePoint=0,conn.database().ref(tblRtAlt[11]+"/"+codeRouteSel).orderByValue().on("value",function(e){1<(codePoint=e.numChildren())&&codePoint++})}function setStopped(){var e=conn.database().ref(tblRtAlt[5]+"/"+plateRouteSel+"/"+codeRouteSel);getCodePoint(),e.update({paradas:codePoint}).then(function(){console.log("setStopped Parada guardada: "+codeRouteSel)}).catch(function(e){setLogErrorData("Error: "+e,"Actualizar",tblRtAlt[5],"setStopped"),console.log("Error al actualizar las paradas: "+e)})}function getDataCar(e){var t=e.indexOf("Placa: ");deleteLi("listaRutas"),cnsUserExistEnt(),plateRouteSel="",codDriverKey="",document.getElementById("codePlaca").innerHTML="",-1!=t&&(t+=7,plateRouteSel=e.substr(t,6),document.getElementById("codePlaca").innerHTML=plateRouteSel,codDriverKey=plateRouteSel,getDataDriver(),getDataRoutes())}function getDataDriver(){var e=conn.database().ref(tblRtAlt[13]+"/"+codDriverKey);document.getElementById("nombreConductor").innerHTML="<b>Nombre Conductor: </b>Sin definir",document.getElementById("telefonoConductor").innerHTML="<b>Telefono Conductor: </b>Sin definir",document.getElementById("fechaConductor").innerHTML="<b>Fecha Vinculación: </b>Sin definir",document.getElementById("documentoConductor").innerHTML="<b>Documento Conductor: </b>Sin definir",e.orderByValue().on("value",function(e){null!=e.child("nombreconductor").val()&&(document.getElementById("nombreConductor").innerHTML="<b>Nombre Conductor: </b>"+e.child("nombreconductor").val()),null!=e.child("phone").val()&&(document.getElementById("telefonoConductor").innerHTML="<b>Telefono Conductor: </b>"+e.child("phone").val()),null!=e.child("fecharegistro").val()&&(document.getElementById("fechaConductor").innerHTML="<b>Fecha Vinculación: </b>"+e.child("fecharegistro").val()),null!=e.child("docconductor").val()&&(document.getElementById("documentoConductor").innerHTML="<b>Documento Conductor: </b>"+e.child("docconductor").val())})}function getStateRoute(a){conn.database().ref(tblRtAlt[1]+"/"+a.id).orderByValue().on("value",function(e){e.forEach(function(e){var t=e.val();if("estado"==e.key)return a.estado=0==t?"Inactivo":"Activo",a})})}function getDataRoutes(){var o=[];conn.database().ref(tblRtAlt[5]+"/"+codDriverKey).orderByValue().on("value",function(e){e.forEach(function(e){var t=e.val(),a={};a.id=t.id,a.nombre=t.name,a.placa=t.placa,getStateRoute(a),o.push(a)})});for(var e=0;e<o.length;e++){var t=document.createElement("li"),a="'"+o[e].placa+"', '"+o[e].id+"', '"+o[e].nombre+"'",r=o[e].id+" - "+o[e].nombre+" - "+o[e].estado,n='<button class="btn_add spaceList" id="'+o[e].placa+"\" onclick=\"closePopUp('m-CnsRouteDetailEnt'); startSelectRoute("+a+');"><img src="../img/drawable/usuario.png" style="height: 26px; width: 26px;"></button>';t.id=o[e].id+""+e,t.innerHTML="<div class='listLeftText'>&nbsp;"+r+"</div><div class='listRightButton'>"+n+"</div>",document.getElementById("listaRutas").appendChild(t)}applyStyle("listaRutas")}function getFilterList(e){var t="";"txtRouteCns"==e&&$("#txtRouteCns").keyup(function(){t=minToMayus($("#txtRouteCns").val()),$("#listaVehiculosCns li").css("display","block"),$("#listaVehiculosCns li").each(function(){-1!=minToMayus($(this).text()).search(t)?$(this).css("display","block"):$(this).css("display","none"),"Listado de Vehiculos"==$(this).text()&&$(this).css("display","block"),"Placa - Ruta - Nombre"==$(this).text()&&$(this).css("display","block")})}),"txtRutaRem"==e&&$("#txtRutaRem").keyup(function(){t=minToMayus($("#txtRutaRem").val()),$("#listaVehiculosDel li").css("display","block"),$("#listaVehiculosDel li").each(function(){-1!=minToMayus($(this).text()).search(t)?$(this).css("display","block"):$(this).css("display","none"),"Listado de Vehiculos a Cargo"==$(this).text()&&$(this).css("display","block"),"Placa - Ruta - Nombre Ruta"==$(this).text()&&$(this).css("display","block")})}),"txtRuta"==e&&$("#txtRuta").keyup(function(){t=minToMayus($("#txtRuta").val()),$("#listaVehiculos li").css("display","block"),$("#listaVehiculos li").each(function(){-1!=minToMayus($(this).text()).search(t)?$(this).css("display","block"):$(this).css("display","none"),"Listado de Vehiculos a Cargo"==$(this).text()&&$(this).css("display","block"),"Placa - Ruta - Nombre"==$(this).text()&&$(this).css("display","block")})}),"txtUserNameCns"==e&&$("#txtUserNameCns").keyup(function(){t=minToMayus($("#txtUserNameCns").val()),$("#listaUsuariosCns li").css("display","block"),$("#listaUsuariosCns li").each(function(){-1!=minToMayus($(this).text()).search(t)?$(this).css("display","block"):$(this).css("display","none"),"Usuarios"==$(this).text()&&$(this).css("display","block"),"Nombre - Celular"==$(this).text()&&$(this).css("display","block")})}),"txtCelularC"==e&&$("#txtCelularC").keyup(function(){t=$("#txtCelularC").val(),$("#listaUsuariosCns li").css("display","block"),$("#listaUsuariosCns li").each(function(){-1!=$(this).text().search(t)?$(this).css("display","block"):$(this).css("display","none"),"Usuarios"==$(this).text()&&$(this).css("display","block"),"Nombre - Celular"==$(this).text()&&$(this).css("display","block")})})}function getDataUserRoute(){deleteLi("listaUsuariosCns"),conn.database().ref(tblRtAlt[11]+"/"+codeRouteSel).orderByValue().on("value",function(e){e.forEach(function(e){var t=conn.database().ref(tblRtAlt[11]+"/"+codeRouteSel+"/"+e.key),r="",n="",l="";t.orderByValue().on("value",function(e){e.forEach(function(e){var t=document.createElement("li"),a=e.val();if("childname"==e.key&&(r=a),"phone"==e.key&&(n=a),"id"==e.key&&(l=a),""!=r&&""!=n&&""!=l){var o=r+" - "+n;t.setAttribute("id",l),t.innerHTML='<div style="display: table-cell; width: 270px; padding: 10px;">&nbsp;'+o+"</div>",document.getElementById("listaUsuariosCns").appendChild(t),l=n=r=""}})})})}),applyStyle("listaUsuariosCns")}function validatePlate(e){var t=$("#"+e).val();""==t.trim()&&msjAlert("Por favor ingresar una placa para continuar",2),t.trim().length<6&&msjAlert("Placa no valida",2)}function setLogErrorData(e,t,a,o){""==myUserId&&initApp();var r=formatoFechaCorta(),n=fecha.getFullYear()+""+d2(parseInt(fecha.getMonth()+1))+d2(fecha.getDate())+d2(fecha.getHours())+d2(fecha.getMinutes())+d2(fecha.getSeconds()),l=conn.database().ref(tblRtAlt[16]+"/"+r+"/"+n);formatoFecha(),l.set({user:myUserId,date:fecha,messaje:e,type:t,table:a,funcion:o}).then(function(){console.log("dato almacenado correctamente")}).catch(function(e){alert("detectado un error",e)})}function setIdRegDoc(e,t,a,o,r){titlePlate=e,startDate=t,endDate=a,numberDoc=o,upLoadDoc=r}function setRemAttributeDocs(e){document.getElementById(""+startDate+e).readonly=!1,document.getElementById(""+endDate+e).readonly=!1,document.getElementById(""+numberDoc+e).readonly=!1}function setAddAttributeDocs(e){document.getElementById(""+startDate+e).readonly=!0,document.getElementById(""+endDate+e).readonly=!0,document.getElementById(""+numberDoc+e).readonly=!0}function setDataDocsView(e,t,a,o,r,n){(null!=t&&$("#"+startDate+e).val(t),null!=a&&$("#"+endDate+e).val(a),null!=o&&$("#"+numberDoc+e).val(o),null!=r&&"download"==upLoadDoc)&&document.getElementById("btnGet"+e+"Car").setAttribute("onclick","abrirOpcionModal('m-CnsFileDownLoad'); getDownloadFile('"+e+"', '"+r+"', '"+n+"');")}function getDataDriverCns(e){console.log("getDataDriver: "+titlePlate),document.getElementById(titlePlate).innerHTML="<b>"+e+"</b>"}function getDataDoc(e){""==entUser&&cnsUsuarioEmpresa();document.getElementById(titlePlate).innerHTML="<b>"+e+"</b>",["soat","matricula","tecnomecanica","funcionamiento"].forEach(function(t){conn.database().ref(tblRtAlt[17]+"/"+entUser+"/"+e+"/"+t).orderByValue().on("value",function(e){setRemAttributeDocs(getCapitalLetter(t)),setDataDocsView(getCapitalLetter(t),e.child("datestart").val(),e.child("dateend").val(),e.child("number").val(),e.child("ref").val(),e.child("document").val()),setAddAttributeDocs(getCapitalLetter(t))})})}function getReference(e,t,a){refStorages=t,tableRef=e,source=a,docDriver=0,$("#btnUpload").val(""),document.getElementById("confirmUpload").innerHTML="",moveBar(0)}function getReferenceDriver(e,t,a,o){refStorages=t,tableRef=e,source=a,docDriver=o,$("#btnUpload").val(""),document.getElementById("confirmUpload").innerHTML="",moveBar(0)}function setUploadFile(e){if(0==docDriver){var t=$("#fecInicio"+source).val(),a=$("#fecVen"+source).val(),o=$("#txtNumero"+source).val();if(document.getElementById("confirmUpload").innerHTML="",resultValidate=0,validaField(t,"No ha ingresado la fecha de inicio del "+source),validaField(a,"No ha ingresado la fecha de vencimiento del "+source),validaField(o,"No ha ingresado el numero del "+source),1==resultValidate)return;(dataDriverUpdate=[]).push(t),dataDriverUpdate.push(a),dataDriverUpdate.push(o),upLoadDocument(e)}if(1==docDriver){var r=$("#txtDocumento").val(),n=$("#txtTipoDoc").val(),l=$("#txtRh").val(),c=$("#txtEps").val(),i=$("#txtNombres").val(),d=$("#txtApellidos").val(),s=$("#txtFechaNac").val(),u=$("#txtEstadoCivil").val();if(resultValidate=0,validaField(r,"No ha ingresado el documento del conductor"),validaField(n,"No ha ingresado el tipo de documento del conductor"),validaField(l,"No ha ingresado el tipo de RH del conductor"),validaField(c,"No ha ingresado la EPS del conductor"),validaField(i,"No ha ingresado el(los) nombre(s) del conductor"),validaField(d,"No ha ingresado el(los) apellido(s) del conductor"),validaField(s,"No ha ingresado la fecha de nacimiento del conductor"),validaField(u,"No ha ingresado el estado civil del conductor"),1==resultValidate)return;(dataDriverUpdate=[]).push(r),dataDriverUpdate.push(n),dataDriverUpdate.push(l),dataDriverUpdate.push(c),dataDriverUpdate.push(i),dataDriverUpdate.push(d),dataDriverUpdate.push(s),dataDriverUpdate.push(u),upLoadDocument(e)}if(2==docDriver){var m=$("#txtFechaLicencia").val(),f=$("#txtVencimiento").val(),v=$("#txtTipoLicencia").val(),g=$("#txtumeroLicencia").val();if(resultValidate=0,validaField(m,"No ha ingresado la fecha de inicio de la licencia"),validaField(f,"No ha ingresado la fecha de vigencia de la licencia"),validaField(v,"No ha ingresado el tipo de licencia"),validaField(g,"No ha ingresado el numero de licencia"),1==resultValidate)return;(dataDriverUpdate=[]).push(m),dataDriverUpdate.push(f),dataDriverUpdate.push(v),dataDriverUpdate.push(g),upLoadDocument(e)}if(3==docDriver&&upLoadDocument(e),4==docDriver){var h=$("#txtNombreContacto").val(),p=$("#txtApellidoContacto").val(),b=$("#txtTelContacto").val();if(resultValidate=0,validaField(h,"No ha ingresado el nombre del contacto"),validaField(p,"No ha ingresado el apellido del contacto"),validaField(b,"No ha ingresado el telefono del contacto"),1==resultValidate)return;(dataDriverUpdate=[]).push(h),dataDriverUpdate.push(p),dataDriverUpdate.push(b)}}function getnameDocument(){switch(docDriver){case 0:switch(source){case"Soat":return $("#txtSoatDocCar").val();case"Matricula":return $("#txtMatriculaDocCar").val();case"Funcionamiento":return $("#txtFuncDocCar").val();case"Tecnomecanica":return $("#txtTecnoDocCar").val()}break;case 1:return $("#txtNomDocDriver").val();case 2:return $("#txtLicDocDriver").val();case 3:return $("#txtCVDocDriver").val()}}function setDownloadURL(e){switch(formatoFecha(),0==onlySave&&(nameDocument=getnameDocument()),docDriver){case 0:if(dataDriverUpdate.length<=0)return;(t=conn.database().ref(tableRef+"/"+entUser+"/"+refStorages)).set({download:e,date:fecha,ref:tableRef+"/"+entUser+refStorages,document:nameDocument,user:myUserId,datestart:dataDriverUpdate[0],dateend:dataDriverUpdate[1],number:dataDriverUpdate[2]}).then(function(){console.log("Dato guardado exitosamente"),0==onlySave&&msjAlert("Datos guardados exitosamente",1)}).catch(function(e){console.log("Error al guardar los datos: "+e),setLogErrorData("Error: "+e,"Insertar",tableRef+"/"+entUser+"/"+refStorages,"setDownloadURL")});break;case 1:if(dataDriverUpdate.length<=0)return;(t=conn.database().ref(tblRtAlt[13]+"/"+codDriverKey)).set({docconductor:dataDriverUpdate[0],tipdocdonductor:dataDriverUpdate[1],rhconductor:dataDriverUpdate[2],epsconductor:dataDriverUpdate[3],nombres:dataDriverUpdate[4],apellidos:dataDriverUpdate[5],fecnacimiento:dataDriverUpdate[6],estadocivil:dataDriverUpdate[7],nombreconductor:dataDriverUpdate[4]+" "+dataDriverUpdate[5],date:fecha,ref:tableRef+"/"+entUser+refStorages,document:nameDocument,user:myUserId}).then(function(){console.log("Dato guardado exitosamente caso "+docDriver),0==onlySave&&msjAlert("Datos guardados exitosamente",1)}).catch(function(e){console.log("Error al guardar datos: "+e+", caso: "+docDriver),setLogErrorData("Error: "+e,"Insertar",tblRtAlt[13],"setDownloadURL")});break;case 2:if(dataDriverUpdate.length<=0)return;var t=conn.database().ref(tableRef+"/"+entUser+"/"+refStorages);console.log("setDownloadURL:"+t),t.set({inicio:dataDriverUpdate[0],vencimiento:dataDriverUpdate[1],tipo:dataDriverUpdate[2],numero:dataDriverUpdate[3],ref:tableRef+"/"+entUser+refStorages,document:nameDocument,date:fecha,user:myUserId}).then(function(){console.log("Dato guardado exitosamente caso "+docDriver),0==onlySave&&msjAlert("Datos guardados exitosamente",1)}).catch(function(e){console.log("Error al guardar datos: "+e+", caso: "+docDriver),setLogErrorData("Error: "+e,"Insertar",tableRef+"/"+entUser+"/"+refStorages,"setDownloadURL")});break;case 3:(t=conn.database().ref(tableRef+"/"+entUser+refStorages)).set({download:e,ref:tableRef+"/"+entUser+refStorages,document:nameDocument,date:fecha,user:myUserId}).then(function(){console.log("Dato guardado exitosamente caso "+docDriver),0==onlySave&&msjAlert("Datos guardados exitosamente",1)}).catch(function(e){console.log("Error al guardar datos: "+e+", caso: "+docDriver),setLogErrorData("Error: "+e,"Insertar",tableRef+"/"+entUser+"/"+refStorages,"setDownloadURL")});break;case 4:if(dataDriverUpdate.length<=0)return;(t=conn.database().ref(tblRtAlt[18]+"/"+plateRouteSel)).set({nombres:dataDriverUpdate[0],apellidos:dataDriverUpdate[1],telefono:dataDriverUpdate[2],date:fecha,user:myUserId}).then(function(){console.log("Dato guardado exitosamente caso "+docDriver),0==onlySave&&msjAlert("Datos guardados exitosamente",1)}).catch(function(e){console.log("Error al guardar datos: "+e+", caso: "+docDriver),setLogErrorData("Error: "+e,"Insertar",tblRtAlt[18],"setDownloadURL")})}}function setRemoveDocument(){document.getElementById("iFrameImagen").removeAttribute("src")}function getDownloadFile(e,t,a){storage.ref(t).child(a).getDownloadURL().then(function(e){document.getElementById("iFrameImagen").setAttribute("src",e)}).catch(function(e){switch(e.code){case"storage/object-not-found":msjAlert("Archivo "+a+" no existe",2);break;case"storage/unauthorized":msjAlert("Usuario no autorizado a descargar el archivo",2);break;case"storage/canceled":msjAlert("Descarga cancelada por el usuario",2);break;case"storage/unknown":msjAlert("Servidor no responde, intente mas tarde",2)}})}function moveBar(e){var t=document.getElementById("myBar");t.style.width=e+"%",t.innerHTML=1*e+"%"}function upLoadDocument(e){if(UpLoadResult=0,""==entUser&&cnsUsuarioEmpresa(),""==myUserId&&initApp(),0!=onlySave){var t=storage.ref(tableRef+"/"+entUser+"/"+refStorages),a=e.target.files[0],o=a.name;switch(docDriver){case 0:switch(source){case"Soat":if(o!=docsPdf[3])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[3]+"<br/>Por favor renombrar y volver a cargar el archivo",2);break;case"Matricula":if(o!=docsPdf[4])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[4]+"<br/>Por favor renombrar y volver a cargar el archivo",2);break;case"Tecnomecanica":if(o!=docsPdf[5])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[5]+"<br/>Por favor renombrar y volver a cargar el archivo",2);break;case"Funcionamiento":if(o!=docsPdf[6])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[6]+"<br/>Por favor renombrar y volver a cargar el archivo",2)}break;case 1:if(o!=docsPdf[0])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[0]+"<br/>Por favor renombrar y volver a cargar el archivo",2);break;case 2:if(o!=docsPdf[1])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[1]+"<br/>Por favor renombrar y volver a cargar el archivo",2);break;case 3:if(o!=docsPdf[2])return void msjAlert("El nombre archivo debe ser<br/>"+docsPdf[2]+"<br/>Por favor renombrar y volver a cargar el archivo",2)}if(""==a.name||null==a.name)return msjAlert("No ha seleccionado un archivo para subir",2),void $("#btnUpload").val("");var r={contentType:a.type,groupId:entUser},n=t.child(o).put(a,r);nameDocument=o,n.on("state_changed",function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);switch(e.state){case firebase.storage.TaskState.PAUSED:break;case firebase.storage.TaskState.RUNNING:moveBar(t)}},function(e){switch(console.log("Error "+e.code),e.code){case"storage/object_not_found":document.getElementById("confirmUpload").innerHTML="<b>Archivo no encontrado</b>",console.log("storage/object_not_found"),UpLoadResult=1;break;case"storage/unauthorized":document.getElementById("confirmUpload").innerHTML="<b>No esta autorizado a subir archivos</b>",console.log("storage/unauthorized"),UpLoadResult=1;break;case"storage/canceled":document.getElementById("confirmUpload").innerHTML="<b>Subida de archivo cancelada</b>",console.log("storage/canceled"),UpLoadResult=1;break;case"storage/unknown":document.getElementById("confirmUpload").innerHTML="<b>Se presento un error desconocido</b>",console.log("storage/unknown"),UpLoadResult=1}},function(){n.snapshot.ref.getDownloadURL().then(function(e){console.log("File available at",e),document.getElementById("confirmUpload").innerHTML="<b>Archivo cargado con exito</b>",console.log("Archivo cargado con exito!"),(UpLoadResult=0)==docDriver&&setDownloadURL(e),1==docDriver&&setDownloadURL(e),2==docDriver&&setDownloadURL(e),3==docDriver&&setDownloadURL(e)})})}}function validaField(e,t){1!=resultValidate&&(""!=e&&null!=e||(msjAlert(t,2),$("#btnUpload").val(""),moveBar(0),resultValidate=1))}function setTextMsgCnf(e){var t=document.getElementById("divCnfUpLoadFile");document.getElementById("btnUpLoadData").disabled=!1,t.innerHTML="Desea cargar el archivo <br/><b>"+e+"?</b><br/>","Contacto"==e&&(document.getElementById("btnUpLoadData").disabled=!0)}function setOnlySave(e){onlySave=e}function getDataDriverUpLoad(e,t){conn.database().ref(tblRtAlt[13]+"/"+e).orderByValue().on("value",function(e){(null!=e.child("document").val()&&$("#txtNomDocDriver"+t).val(e.child("document").val()),null!=e.child("docconductor").val()&&$("#txtDocumento"+t).val(e.child("docconductor").val()),null!=e.child("tipdocdonductor").val()&&$("#txtTipoDoc"+t).val(e.child("tipdocdonductor").val()),null!=e.child("rhconductor").val()&&$("#txtRh"+t).val(e.child("rhconductor").val()),null!=e.child("epsconductor").val()&&$("#txtEps"+t).val(e.child("epsconductor").val()),null!=e.child("nombres").val()&&$("#txtNombres"+t).val(e.child("nombres").val()),null!=e.child("apellidos").val()&&$("#txtApellidos"+t).val(e.child("apellidos").val()),null!=e.child("fecnacimiento").val()&&$("#txtFechaNac"+t).val(e.child("fecnacimiento").val()),null!=e.child("estadocivil").val()&&$("#txtEstadoCivil"+t).val(e.child("estadocivil").val()),null!=e.child("ref").val())&&document.getElementById("btnPersonalDataCns").setAttribute("onclick","abrirOpcionModal('m-CnsFileDownLoad'); getDownloadFile('', '"+e.child("ref").val()+"', '"+e.child("document").val()+"');")}),conn.database().ref(tblRtAlt[18]+"/"+plateRouteSel).orderByValue().on("value",function(e){null!=e.child("apellidos").val()&&$("#txtApellidoContacto"+t).val(e.child("apellidos").val()),null!=e.child("nombres").val()&&$("#txtNombreContacto"+t).val(e.child("nombres").val()),null!=e.child("telefono").val()&&$("#txtTelContacto"+t).val(e.child("telefono").val())}),conn.database().ref(tblRtAlt[17]+"/"+entUser+"/"+e+"/licencia").orderByValue().on("value",function(e){(null!=e.child("document").val()&&$("#txtLicDocDriver"+t).val(e.child("document").val()),null!=e.child("inicio").val()&&$("#txtFechaLicencia"+t).val(e.child("inicio").val()),null!=e.child("vencimiento").val()&&$("#txtVencimiento"+t).val(e.child("vencimiento").val()),null!=e.child("tipo").val()&&$("#txtTipoLicencia"+t).val(e.child("tipo").val()),null!=e.child("numero").val()&&$("#txtumeroLicencia"+t).val(e.child("numero").val()),null!=e.child("ref").val())&&document.getElementById("btnDriverDocumentCns").setAttribute("onclick","abrirOpcionModal('m-CnsFileDownLoad'); getDownloadFile('', '"+e.child("ref").val()+"', '"+e.child("document").val()+"');")}),conn.database().ref(tblRtAlt[17]+"/"+entUser+"/"+e+"/cv").orderByValue().on("value",function(e){(null!=e.child("document").val()&&$("#txtCVDocDriver"+t).val(e.child("document").val()),null!=e.child("ref").val())&&document.getElementById("btnCurriculumCns").setAttribute("onclick","abrirOpcionModal('m-CnsFileDownLoad'); getDownloadFile('', '"+e.child("ref").val()+"', '"+e.child("document").val()+"');")})}
